<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta name="renderer" content="webkit">
    <title>领队管理</title>
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/pintuer.css">
    <link rel="stylesheet" href="../css/admin.css">
    <script src="../js/jquery.js"></script>
    <script src="../js/pintuer.js"></script>
    <script type="text/javascript">
        $(function () {
            //点击删除前
            $("a[href='#yes'], a[href='#no'], th:first, .ckb").hide();
            //点击删除事件
            $("a[href='#del']").css("color", "red")
                .click(function () {
                    $(this).hide();
                    $("a[href='#yes'], a[href='#no'], th:first, .ckb").show();
                });
            //点击确认删除
            $("a[href='#yes']").click(function () {
                var intL = $("input:checked").length; // 获取所有复选框选中项
                if (intL != 0) { // 如果有选中项
                    alert("您确定要删除所选的领队吗？");
                    $("input[type=checkbox]").each(function (index) { // 遍历全部复选框的行
                        if (this.checked) { // 如果选中
                            $(this).parent("td").parent("tr").remove();// 获取选中的值，并删除对应内容
                        }
                    })
                } else {
                    alert("请先选中要删除的领队！");
                }
            });
            //点击取消删除
            $("a[href='#no']").click(function () {
                $("a[href='#yes'], a[href='#no'], th:first, .ckb").hide();
                $("a[href='#del']").show();
            });
            //全选复选框
            $("input[value='all']").click(function () {
                if (this.checked) { // 如果自己被选中
                    $("input[type=checkbox]").prop("checked", true);
                } else { // 如果自己没被选中
                    $("input[type=checkbox]").prop("checked", false);
                }
            });
        });
    </script>
    <style>
        .dialog-body td{
            border: none;
        }
        .panel-head{overflow: hidden}
        .panel-head strong{line-height: 42px}
        .panel-head .input {
            display: inline !important;
            width: 15%;
            margin-right: 5px;
        }

        ul.pagination > li > span, ul.pagination > li > a, ul.pagination > li.active > a, ul.pager > li > span {
            cursor: pointer;
        }
        .pagination > li{margin: 10px 0}

        .input-page-div > input {
            width: 5em;
            height: 1.8em;
            margin: 0.4em 0.2em 0.2em 0.2em;
            text-align: center;
        }

        .input-page-div > .input-btn-xs {
            margin-left: 1em;
            font-size: 1em;
            width: 3em;
            background-color: #337ab7;
            color: #fff;
        }

        .input-page-div {
            display: inline-block;
            margin-left: 1em;
            float: right;
            margin-top: 10px;
        }

        /*自定义样式*/
        /*分页*/
        .mypagenav {
            margin-top: 40px;
            float: right;
        }

        .mypagenav > li {
            float: left;
            margin-left: 1em;
            list-style: none;
            width: 1.1em;
        }

        .mypagenav > li.active > a {
            color: #f00;
        }

        .mypagenav > li > span {
            cursor: pointer;
        }

        .mypagenav > li.disabled > span {
            cursor: default;
            color: #999;
        }
    </style>
</head>
<body>
<div class="panel admin-panel">
    <div class="panel-head">
        <strong><span class="icon-user"></span> 领队管理</strong>
        <button class="button border-blue float-right">
            查询 <span class="icon-search-plus"></span>
        </button>
        <input type="text" class="input float-right"
               name="searchTxt" placeholder="输入手机号进行查询"/>
        <input type="text" class="input float-right"
               name="searchTxt" placeholder="输入姓名进行查询"/>
    </div>
    <div class="padding border-bottom" style="overflow: hidden">
        <span class="float-right">
            <a style="margin-right: 20px" class="icon-plus-square-o" href="leaderMng-add.html"> 添加领队</a>
            <a class="icon-trash-o" href="#del" style="margin-right: 20px"> 删除领队</a>
            <a href="#yes"> 确认删除</a>&nbsp;
            <a href="#no" style="margin-right: 20px"> 取消删除</a>
        </span>
    </div>
    <table class="table table-hover text-center">
        <tr>
            <th>
                全选 <input type="checkbox" value="all">
            </th>
            <th>工号</th>
            <th>昵称</th>
            <th>真实姓名</th>
            <th>性别</th>
            <th>年龄</th>
            <th>手机号码</th>
            <th>评分</th>
            <th>带队次数</th>
            <th>查看</th>
        </tr>
        <tr>
            <td class="ckb"><input type="checkbox"></td>
            <td>test1</td>
            <td>测试昵称</td>
            <td>测试真实姓名</td>
            <td>男</td>
            <td>21</td>
            <td>13798950001</td>
            <td>4.8</td>
            <td>11</td>
            <td><a href="leaderMng-detail.html">详细信息</a></td>
        </tr>
        <tr>
            <td class="ckb"><input type="checkbox"></td>
            <td>test2</td>
            <td>测试昵称</td>
            <td>测试真实姓名</td>
            <td>男</td>
            <td>22</td>
            <td>13798950002</td>
            <td>4.8</td>
            <td>11</td>
            <td><a href="leaderMng-detail.html">详细信息</a></td>
        </tr>
        <tr>
            <td class="ckb"><input type="checkbox"></td>
            <td>test3</td>
            <td>测试昵称</td>
            <td>测试真实姓名</td>
            <td>男</td>
            <td>23</td>
            <td>13798950003</td>
            <td>4.8</td>
            <td>11</td>
            <td><a href="leaderMng-detail.html">详细信息</a></td>
        </tr>
        <tr>
            <td class="ckb"><input type="checkbox"></td>
            <td>test4</td>
            <td>测试昵称</td>
            <td>测试真实姓名</td>
            <td>男</td>
            <td>24</td>
            <td>13798950004</td>
            <td>4.8</td>
            <td>11</td>
            <td><a href="leaderMng-detail.html">详细信息</a></td>
        </tr>
        <tr>
            <td class="ckb"><input type="checkbox"></td>
            <td>test5</td>
            <td>测试昵称</td>
            <td>测试真实姓名</td>
            <td>男</td>
            <td>25</td>
            <td>13798950005</td>
            <td>4.8</td>
            <td>11</td>
            <td><a href="leaderMng-detail.html">详细信息</a></td>
        </tr>
        <tr>
            <td class="ckb"><input type="checkbox"></td>
            <td>test6</td>
            <td>测试昵称</td>
            <td>测试真实姓名</td>
            <td>男</td>
            <td>26</td>
            <td>13798950006</td>
            <td>4.8</td>
            <td>11</td>
            <td><a href="leaderMng-detail.html">详细信息</a></td>
        </tr>
        <tr>
            <td class="ckb"><input type="checkbox"></td>
            <td>test7</td>
            <td>测试昵称</td>
            <td>测试真实姓名</td>
            <td>男</td>
            <td>27</td>
            <td>13798950007</td>
            <td>4.8</td>
            <td>11</td>
            <td><a href="leaderMng-detail.html">详细信息</a></td>
        </tr>
        <tr>
            <td colspan="9">
                <!--<div class="pagelist"><a href="">上一页</a> <span class="current">1</span><a href="">2</a><a-->
                        <!--href="">3</a><a href="">下一页</a><a href="">尾页</a></div>-->
                <div id="demo1"></div>
            </td>
        </tr>
    </table>
</div>
<script>
    createPageNav({
        $container:$("#demo1"),
        pageCount:20
    });

    //分页，页码导航,要求参数为一个对象
    function createPageNav(opt) {
        opt= opt || {};
        var $container   = opt.$container          || null, //必需，页码容器，请确保这个容器只用来存放页码导航
            pageCount    = Number(opt.pageCount)   || 0,    //必需，页码总数
            currentNum   = Number(opt.currentNum)  || 1,    //选填，当前页码
            maxCommonLen = Number(opt.maxCommonLen)|| 10,   //选填，普通页码的最大个数

            className = opt.className  || "pagination",//选填，分页类型：pagination或pager等
            preText   = opt.preText    || "上一页",      //选填，上一页文字显示，适用于只有前后页按钮的情况
            nextText  = opt.nextText   || "下一页",      //选填，下一页文字，同上
            firstText = opt.firstText  || "首页",
            lastText  = opt.lastText   || "末页",

            hasFirstBtn  = opt.hasFirstBtn   === false ? false : true,
            hasLastBtn   = opt.hasLastBtn    === false ? false : true,
            hasPreBtn    = opt.hasPreBtn     === false ? false : true,
            hasNextBtn   = opt.hasNextBtn    === false ? false : true,
            hasInput     = opt.hasInput      === false ? false : true,
            hasCommonPage= opt.hasCommonPage === false ? false : true,//选填，是否存在普通页

            beforeFun = opt.beforeFun || null,  //选填，页码跳转前调用的函数，可通过返回false来阻止跳转，可接收目标页码参数
            afterFun  = opt.afterFun  || null,  //选填，页码跳转后调用的函数，可接收目标页码参数
            noPageFun = opt.noPageFun || null;  //选填，页码总数为0时调用的函数

        //当前显示的最小页码，用于计算起始页码，直接容器,当前页，前，后，首，末，输入框
        var minNum=1,changeLen,$parent,$currentPage,$preBtn,$nextBtn,$firstBtn,$lastBtn,$input;

        //容器
        if (!$container || $container.length != 1){
            console.log("分页容器不存在或不正确");
            return false;
        }
        //总页数
        if(pageCount <= 0){
            if(noPageFun) noPageFun();
            return false;
        }
        //当前页
        if (currentNum < 1) currentNum = 1;
        else if (currentNum > pageCount) currentNum = pageCount;
        //普通页码的最大个数，起始页算法限制，不能小于3
        if(maxCommonLen<3) maxCommonLen=3;
        //跳转页响应长度，用于计算起始页码
        if(maxCommonLen>=8) changeLen=3;
        else if(maxCommonLen>=5) changeLen=2;
        else changeLen=1;

        $container.hide();
        _initPageNav();
        $container.show();

        function _initPageNav(){
            var initStr = [];
            initStr.push('<nav><ul class="'+ className +'" onselectstart="return false">');
            if(hasFirstBtn)initStr.push('<li class="first-page" value="1"><span>'+ firstText +'</span></li>');
            if(hasPreBtn)  initStr.push('<li class="pre-page"  value="' + (currentNum - 1) + '"><span>'+ preText +'</span></li>');
            if(hasNextBtn) initStr.push('<li class="next-page" value="' + (currentNum + 1) + '"><span>'+ nextText +'</span></li>');
            if(hasLastBtn) initStr.push('<li class="last-page" value="' + pageCount + '"><span>'+ lastText +'</span></li>');
            if(hasInput)
                initStr.push('<div class="input-page-div">当前第<input type="text" maxlength="6" value="' + currentNum + '" />页，共<span>'
                    + pageCount
                    + '</span>页<button type="button" class="btn btn-xs input-btn-xs">确定</button></div>');
            initStr.push('</ul></nav>');

            $container.html(initStr.join(""));
            //初始化变量
            $parent=$container.children().children();
            if(hasFirstBtn) $firstBtn = $parent.children("li.first-page");
            if(hasPreBtn)   $preBtn   = $parent.children("li.pre-page");
            if(hasNextBtn)  $nextBtn  = $parent.children("li.next-page");
            if(hasLastBtn)  $lastBtn  = $parent.children("li.last-page");
            if(hasInput){
                $input  = $parent.find("div.input-page-div>input");
                $parent.find("div.input-page-div>button").click(function(){
                    _gotoPage($input.val());
                });
            }
            //初始化功能按钮
            _buttonToggle(currentNum);
            //生成普通页码
            if(hasCommonPage) {
                _createCommonPage(_computeStartNum(currentNum), currentNum);
            }
            //绑定点击事件
            $parent.on("click", "li",function () {
                var $this=$(this);
                if ($this.is("li") && $this.attr("value")){
                    if(!$this.hasClass("disabled") && !$this.hasClass("active")){
                        _gotoPage($this.attr("value"));
                    }
                }
            });
        }
        //跳转到页码
        function _gotoPage(targetNum) {
            targetNum=_formatNum(targetNum);
            if (targetNum == 0 || targetNum == currentNum) return false;
            // 跳转前回调函数
            if (beforeFun && beforeFun(targetNum) === false) return false;
            //修改值
            currentNum=targetNum;
            if(hasInput)   $input.val(targetNum);
            if(hasPreBtn)  $preBtn.attr("value", targetNum - 1);
            if(hasNextBtn) $nextBtn.attr("value", targetNum + 1);
            //修改功能按钮的状态
            _buttonToggle(targetNum);
            // 计算起始页码
            if(hasCommonPage) {
                var starNum = _computeStartNum(targetNum);
                if (starNum == minNum) {// 要显示的页码是相同的
                    $currentPage.removeClass("active");
                    $currentPage = $parent.children("li.commonPage").eq(targetNum - minNum).addClass("active");
                }
                else {// 需要刷新页码
                    _createCommonPage(starNum, targetNum);
                }
            }
            // 跳转后回调函数
            if (afterFun) afterFun(targetNum);
        }
        //整理目标页码的值
        function _formatNum(num){
            num = Number(num);
            if(isNaN(num)) num=0;
            else if (num <= 0) num = 1;
            else if (num > pageCount) num = pageCount;
            return num;
        }
        //功能按钮的开启与关闭
        function _buttonToggle(current){
            if (current == 1) {
                if(hasFirstBtn) $firstBtn.addClass("disabled");
                if(hasPreBtn)   $preBtn.addClass("disabled");
            }
            else {
                if(hasFirstBtn) $firstBtn.removeClass("disabled");
                if(hasPreBtn)   $preBtn.removeClass("disabled");
            }

            if (current == pageCount) {
                if(hasNextBtn) $nextBtn.addClass("disabled");
                if(hasLastBtn) $lastBtn.addClass("disabled");
            }
            else {
                if(hasNextBtn) $nextBtn.removeClass("disabled");
                if(hasLastBtn) $lastBtn.removeClass("disabled");
            }
        }
        //计算当前显示的起始页码
        function _computeStartNum(targetNum) {
            var startNum;
            if (pageCount <= maxCommonLen)
                startNum = 1;
            else {
                if ((targetNum - minNum) >= (maxCommonLen-changeLen)) {//跳转到靠后的页码
                    startNum = targetNum - changeLen;
                    if ((startNum + maxCommonLen-1) > pageCount) startNum = pageCount - (maxCommonLen-1);// 边界修正
                }
                else if ((targetNum - minNum) <= (changeLen-1)) {//跳转到靠前的页码
                    startNum = targetNum - (maxCommonLen-changeLen-1);
                    if (startNum <= 0) startNum = 1;// 边界修正
                }
                else {// 不用改变页码
                    startNum = minNum;
                }
            }
            return startNum;
        }
        //生成普通页码
        function _createCommonPage(startNum, activeNum) {
            var initStr = [];
            for (var i = 1,pageNum=startNum; i <= pageCount && i <= maxCommonLen; i++ , pageNum++) {
                initStr.push('<li class="commonPage" value="' + pageNum + '"><a href="javascript:">' + pageNum + '</a></li>');
            }

            $parent.hide();
            $parent.children("li.commonPage").remove();
            if(hasPreBtn) $preBtn.after(initStr.join(""));
            else if(hasFirstBtn) $firstBtn.after(initStr.join(""));
            else $parent.prepend(initStr.join(""));
            minNum = startNum;
            $currentPage = $parent.children("li.commonPage").eq(activeNum-startNum).addClass("active");
            $parent.show();
        }
    }
</script>
</body>
</html>
